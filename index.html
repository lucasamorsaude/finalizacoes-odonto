<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Finalização de Procedimento</title>
</head>
<body>
  <h1>Finalizar Procedimento</h1>
  <form id="finalizacaoForm">
    <label>Nome do Paciente:<br>
      <input type="text" id="nomePaciente" required>
    </label><br><br>
    
    <label>Profissional:<br>
      <select id="profissional" required>
        <option value="">Selecione</option>
        <option>Dentista 1</option>
        <option>Dentista 2</option>
        <option>Dentista 3</option>
      </select>
    </label><br><br>

    <button type="submit">Finalizar</button>
  </form>

  <p id="mensagem"></p>

  <script>
    document.getElementById("finalizacaoForm").addEventListener("submit", function(e) {
      e.preventDefault();
      
      const nomePaciente = document.getElementById("nomePaciente").value;
      const profissional = document.getElementById("profissional").value;

      fetch("https://script.google.com/macros/s/AKfycbzkyAQrjXOuCef0HGB25kCeOyY3jaM6cqrUPg5oLj-Lzfc_DykkKtlL8wp5rzyo85sXYg/exec", {
        method: "POST",
        body: JSON.stringify({
          nomePaciente,
          profissional
        }),
        headers: {
          "Content-Type": "application/json"
        }
      }).then(response => {
        // Verifique se a resposta foi bem-sucedida (status 2xx)
        if (response.ok) {
            return response.json(); // Se a resposta é OK, parseie como JSON
        } else {
            throw new Error('Erro na requisição: ' + response.statusText);
        }
      }).then(data => {
        // Se o status no JSON for 'success'
        if (data.status === "success") {
          document.getElementById("mensagem").textContent = data.message;
          document.getElementById("finalizacaoForm").reset();
        } else {
            document.getElementById("mensagem").textContent = "Erro ao enviar dados: " + data.message;
        }
      }).catch(error => {
          document.getElementById("mensagem").textContent = "Erro ao enviar dados: " + error.message;
      });
    });
  </script>
</body>
</html>